{# Datepicker javascript #}
{% block date_javascript %}
    <script type="text/javascript">
        var $field = $('#{{ id }}');

        $(function () {
            {% block date_javascript_prototype %}
            Imatic.View.Datepicker.init($field, {{ app.request.locale|json_encode|raw }})
            {% endblock %}
        });
    </script>
{% endblock %}

{% block datetime_javascript %}
    {{ block('date_javascript') }}
{% endblock %}

{% block time_javascript %}
    {{ block('date_javascript') }}
{% endblock %}

{# Collection prototype javascript #}
{% block collection_javascript %}
    {{ block('form_javascript') }}

    {% if prototype is defined %}
        <script type="text/javascript">
            Imatic.View.Collection.registerPrototypeFields(
                {{ imatic_view_form_javascript_prototype(form) }},
                $('#collection{{ id }}_form_group')[0]
            );
        </script>
    {% endif %}
{% endblock %}

{# Fix missing form_message #}
{% block file_widget %}
{% spaceless %}
{% set type = type|default('file') %}
{% set attr = attr|merge({'class': attr.class|default('') ~ ' ' ~ widget_form_control_class}) %}
    {% if widget_addon_prepend|default(null) is not null %}
        {% set widget_addon = widget_addon_prepend %}
        {{ block('widget_addon') }}
    {% endif %}
<input type="{{ type }}" {{ block('widget_attributes') }}/>
{% if type != 'hidden' and widget_addon.type|default(null) is not null %}
    {% if widget_addon_append|default(null) is not null %}
        {% set widget_addon = widget_addon_append %}
        {{ block('widget_addon') }}
    {% endif %}
{% endif %}
{{ block('form_message') }}
{% endspaceless %}
{% endblock file_widget %}
